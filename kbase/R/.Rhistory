library(ggplot2)
library(dplyr)
library(maps)
library(ggmap)
library(mongolite)
library(lubridate)
library(gridExtra)
require (sqldf)
install.packages(c("gridExtra", "lubridate"))
library(ggplot2)
library(dplyr)
library(maps)
library(ggmap)
library(mongolite)
library(lubridate)
library(gridExtra)
require (sqldf)
col_partidos <- mongo("partidos", url = "mongodb://localhost:27017/eleicoes")
df_partidos = col_partidos$find ('{}')
sqldf("SELECT * FROM df_partidos ORDER BY Legenda ASC")
col_partidos <- mongo("partidos", url = "mongodb://localhost:27017/eleicoes")
df_partidos = col_partidos$find ('{}')
sqldf("SELECT * FROM df_partidos ORDER BY Legenda ASC")
col_locais_votacao <- mongo("locais_votacao", url = "mongodb://localhost:27017/eleicoes")
df_locais_votacao = col_locais_votacao$find ('{}')
col_secao_votacao_mun <- mongo("secao_votacao_mun", url = "mongodb://localhost:27017/eleicoes")
df_secao_votacao_mun = col_secao_votacao_mun$find ('{}')
View(df_secao_votacao_mun)
View(df_partidos)
View(df_locais_votacao)
View(df_locais_votacao)
col_secao_votacao_mun <- mongo("secao_votacao_mun", url = "mongodb://localhost:27017/eleicoes")
df_secao_votacao_mun = col_secao_votacao_mun$find ('{}')
source(file = "ler_dados.R")
source(file = "ler_dados.R", encoding = "UTF-8")
setwd('/home/usuario/www/repositorios/datascience/kbase/R') # linux
source(file = "ler_dados.R", encoding = "UTF-8")
sqldf("SELECT * FROM df_partidos ORDER BY Legenda ASC")
source(file = "ler_dados.R", encoding = "UTF-8")
sqldf("SELECT * FROM df_partidos ORDER BY Legenda ASC")
View(df_locais_votacao)
View(df_secao_votacao_mun)
View(df_secao_votacao_mun)
sqldf("
SELECT *
FROM df_partidos p
LEFT JOIN df_secao_votacao_num v ON p.Legenda = v.NR_PARTIDO
")
sqldf("
SELECT *
FROM df_partidos p
LEFT JOIN df_secao_votacao_mun v ON p.Legenda = v.NR_PARTIDO
")
sqldf("
SELECT p.Nome, SUM(*) as votos
FROM df_partidos p
LEFT JOIN df_secao_votacao_mun v ON p.Legenda = v.NR_PARTIDO
GROUP BY p.Nome
")
sqldf("
SELECT p.Nome, SUM(v.QT_VOTOS) as votos
FROM df_partidos p
LEFT JOIN df_secao_votacao_mun v ON p.Legenda = v.NR_PARTIDO
GROUP BY p.Nome
")
sqldf("
SELECT p.Nome, SUM(v.QT_VOTOS) as votos
FROM df_partidos p
LEFT JOIN df_secao_votacao_mun v ON p.Legenda = v.NR_PARTIDO
GROUP BY p.Nome
ORDER BY votos DESC
")
sqldf("
SELECT p.Nome, SUM(v.QT_VOTOS) as votos
FROM df_partidos p
LEFT JOIN df_secao_votacao_mun v ON p.Legenda = v.NR_PARTIDO
GROUP BY p.Nome
ORDER BY votos DESC
HAVING COUNT votos > 0
")
sqldf("
SELECT p.Nome, SUM(v.QT_VOTOS) as votos
FROM df_partidos p
LEFT JOIN df_secao_votacao_mun v ON p.Legenda = v.NR_PARTIDO
GROUP BY p.Nome
ORDER BY votos DESC
HAVING SUM(votos) > 0
")
sqldf("
SELECT p.Nome, SUM(v.QT_VOTOS) as votos
FROM df_partidos p
LEFT JOIN df_secao_votacao_mun v ON p.Legenda = v.NR_PARTIDO
GROUP BY p.Nome
ORDER BY votos DESC
HAVING COUNT(votos) > 0
")
sqldf("
SELECT p.Nome, SUM(v.QT_VOTOS) as votos
FROM df_partidos p
LEFT JOIN df_secao_votacao_mun v ON p.Legenda = v.NR_PARTIDO
GROUP BY p.Nome
HAVING COUNT(votos) > 0
ORDER BY votos DESC
")
sqldf("
SELECT p.Nome, SUM(v.QT_VOTOS) as votos
FROM df_partidos p
LEFT JOIN df_secao_votacao_mun v ON p.Legenda = v.NR_PARTIDO
GROUP BY p.Nome
HAVING SUM(votos) > 0
ORDER BY votos DESC
")
sqldf("
SELECT p.Nome, SUM(v.QT_VOTOS) as votos
FROM df_partidos p
LEFT JOIN df_secao_votacao_mun v ON p.Legenda = v.NR_PARTIDO
GROUP BY p.Nome
HAVING SUM(v.QT_VOTOS) > 0
ORDER BY votos DESC
")
View(df_partidos)
sqldf("
SELECT p.Sigla, SUM(v.QT_VOTOS) as votos
FROM df_partidos p
LEFT JOIN df_secao_votacao_mun v ON p.Legenda = v.NR_PARTIDO
GROUP BY p.Sigla
HAVING SUM(v.QT_VOTOS) > 0
ORDER BY votos DESC
")
df1 = sqldf("
SELECT p.Sigla, SUM(v.QT_VOTOS) as votos
FROM df_partidos p
LEFT JOIN df_secao_votacao_mun v ON p.Legenda = v.NR_PARTIDO
GROUP BY p.Sigla
HAVING SUM(v.QT_VOTOS) > 0
ORDER BY votos DESC
")
ggplot(df1)
ggplot(data = df1)
